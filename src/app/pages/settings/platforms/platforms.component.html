<div class="container">
    <h3>Platforms</h3>
    <div class="form-group required">
      <label for="platform">Platform setup script</label>
      <select (change)="platformSelected(settingsModel.platform)" [(ngModel)]="settingsModel.platform" enabled class="form-control" name="platform" id="platform">
        <option [ngValue]="newPlatform" (value)="newPlatform">Create new</option>
        <optgroup label="_________"></optgroup>
        <ng-container *ngFor="let item of settingsModel.platform_list let i = index">
          <option [ngValue]="settingsModel.platform_list[i]">{{ item.platform_name}}</option>
        </ng-container>
      </select>
      </div>
      <div *ngIf="settingsModel.platform" class="form-group">
        <label for="platform_name">Platform name</label>
        <input [(ngModel)]="settingsModel.platform.platform_name" [(value)]="settingsModel.platform.platform_name" class="form-control" id="new_platform_name" name="new_platform_name" placeholder="Please enter name for new platform">
      </div>     
    <div class="form-container">
      <h4>Platform variables</h4>
      <div *ngFor="let item of settingsModel.platform.variables let i = index" class="form-group repeated">
        <input [(ngModel)]="settingsModel.platform.variables[i].name"  class="form-control" id="platform-name" name="variable" placeholder="Enter variable key">
        <input [(ngModel)]="settingsModel.platform.variables[i].value" class="form-control" id="platform-value" name="variable" placeholder="Enter variable value">
        <span (click)="removeRepeatField(settingsModel.platform.variables, i)" *ngIf="settingsModel.platform.variables && settingsModel.platform.variables.length > 1" class="text-danger remove-btn">Remove</span>
        <span (click)="cleanFields(settingsModel.platform.variables)" *ngIf="settingsModel.platform.variables && settingsModel.platform.variables.length === 1 && settingsModel.platform.variables[0].value !== null" style="right: -50px" class="text-warning remove-btn">Reset</span>
      </div>
    <button (click)="addRepeatField(settingsModel.platform.variables)" type="button" id="yellow-button">Add another variable</button>
    </div>
    <div class="form-group">
      <div>
        <div>
          <br/>
          <br/>
          <br/>
          Parameters to be provided when calling Setup script <br/>
          $SERVER_NAME   - server name <br/>
          $DESCRIPTION   - application description <br/>
          $SSH_IP        - server ip address <br/>
          $SSH_KEY       - server user ssh key <br/>
          $SSH_USERNAME  - username to access server<br/>
          $PORTS         - list of ports to be defined when seputing server <br/>
          $SERVER_DEPENDENCIES - list of server dependencies. All the scripts are available with given name (pre_name and post_name) in the same folder with this specific script<br/>
          $CUSTOM_DEPENDENCIES - list of custom dependencies. Scripts is available with given name in the same folder with this specific script<br/>
        </div>
        <h4>Platform setup script</h4>
      </div>
      <textarea [(ngModel)]="settingsModel.platform.setup_script" [(value)]="settingsModel.platform.setup_script" class="form-control" id="script" name="script" rows="10"></textarea>
    </div>
    <div class="form-group">
      <h4>Platform cleanup script</h4>
      <textarea [(ngModel)]="settingsModel.platform.cleanup_script" [(value)]="settingsModel.platform.cleanup_script" class="form-control" id="script" name="script" rows="10"></textarea>
    </div>
    <div class="form-group">
      <h4>Platform documentation</h4>
      <div>
        Available keys: <br/>
        server_name, description, ssh_ip, ssh_key, ssh_username, ports, server_dependencies, custom_dependencies, platform
      </div>
      <textarea (change)="docUpdated()"[(ngModel)]="settingsModel.doc_string" [(value)]="settingsModel.doc_string" class="form-control" id="script" name="script" rows="10" [disabled]="!settingsModel.platform"></textarea>
      <div *ngIf="settingsModel.jsonValidationMessage">
        <label class="badge badge-danger" id="json-warning" name="json-warning"> {{settingsModel.jsonValidationMessage}}</label>
      </div>
    </div>
    <button (click)="updatePlatform()" id="green-button" *ngIf="!isNewPlatform">Update</button>
    <button (click)="createPlatform()" id="green-button" *ngIf="isNewPlatform">Create</button>
    <button (click)="deletePlatform()" id="red-button" [disabled]="isNewPlatform">Delete</button>
  </div>